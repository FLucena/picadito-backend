spring.application.name=picadito-backend

# Default active profile (puede ser sobrescrito por variable de entorno)
spring.profiles.active=${SPRING_PROFILES_ACTIVE:prod}

# Puerto dinámico (las plataformas asignan el puerto)
server.port=${PORT:8080}

# Common JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update

# JWT Configuration
# IMPORTANTE: En producción, JWT_SECRET DEBE estar definido como variable de entorno
# No se proporciona valor por defecto por seguridad
# Longitud mínima recomendada: 32 caracteres
jwt.secret=${JWT_SECRET:}
jwt.expiration=86400000
jwt.refresh-expiration=604800000
jwt.issuer=${JWT_ISSUER:picadito-backend}
jwt.audience=${JWT_AUDIENCE:picadito-frontend}

# Content Security Policy Configuration
# URI para reportar violaciones de CSP (opcional)
app.security.csp.report-uri=${CSP_REPORT_URI:}
# Fuentes adicionales permitidas para connect-src (separadas por espacios)
app.security.csp.allowed-sources=${CSP_ALLOWED_SOURCES:https://picadito-backend.onrender.com https://unpicadito.vercel.app}

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.metrics.export.prometheus.enabled=true

# Cache Configuration
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=500,expireAfterWrite=10m

# Swagger/OpenAPI Configuration
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method

# CORS Configuration (can be overridden by environment variables)
# Incluye localhost para desarrollo y dominio de producción de Vercel
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:5173,http://127.0.0.1:5173,https://unpicadito.vercel.app}

# Rate Limiting Configuration
# Límites de requests por minuto por tipo de endpoint
app.rate-limit.public.requests-per-minute=${RATE_LIMIT_PUBLIC:100}
app.rate-limit.authenticated.requests-per-minute=${RATE_LIMIT_AUTHENTICATED:200}
app.rate-limit.admin.requests-per-minute=${RATE_LIMIT_ADMIN:500}
app.rate-limit.user.requests-per-minute=${RATE_LIMIT_USER:300}

# Server Configuration - Request Limits and Timeouts
# Límite de tamaño de request body (10MB por defecto)
server.tomcat.max-http-post-size=10MB
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Timeouts de conexión
server.connection-timeout=20000
spring.mvc.async.request-timeout=30000

# Límites de parámetros de query string
server.tomcat.max-parameter-count=1000
server.tomcat.max-http-form-post-size=10MB
